<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <title>Admin side</title>

    <style>
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        body {
            background: url(l7.png) no-repeat center center;
            background-size: contain;
            background-color: white;
            background-repeat: no-repeat;
            background-position: 80% center;
        }

        .bubble {
            position: relative;
            z-index: 2;
            position: absolute;
            width: 300px;
            height: 300px;
            background: #b3dbfe;
            border-radius: 50% 30%;
            opacity: 0.4;
            /* z-index: 0; */
        }

        .bubble1 {
            position: relative;
            z-index: 2;
            position: absolute;
            width: 300px;
            height: 300px;
            background: #f1984b;
            border-radius: 50% 30%;
            opacity: 0.4;
            /* z-index: 0; */
        }

        .top-left {
            top: -230px;
            left: -40px;
        }

        .top-right {
            top: -180px;
            right: -50px;
        }

        .bottom-left {
            bottom: -90px;
            left: -170px;
        }

        .bottom-right {
            bottom: -200px;
            right: -40px;
        }

        .box {
            width: 500px;
            /* height: 100px; */
            margin: 30px auto;
            /* background: white; */
            padding: 40px;
            border-radius: 2px;
            margin-right: 580px;
        }

        .box h4 {
            text-align: center;
            font-size: 17px;
            margin-top: -5px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .space {
            letter-spacing: 4px;
        }

        form {
            flex-direction: column;
            margin-top: 20px;
        }

        form p {
            text-align: center;
            font-size: 10px;
            margin-bottom: 10px;
        }

        form label {
            margin-bottom: 5px;
            font-size: 10px;
            font-weight: 600;
            text-align: left;
        }

        form input {
            width: 100%;
            height: 30px;
            font-size: 10px;
            margin-top: 3px;
            margin-bottom: 10px;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            outline: none;
        }

        form input:focus {
            outline: none;
            border: 1px solid #007fc9;
        }

        #login-error {
            color: red;
            font-size: 11px;
            font-weight: 900;
            text-align: center;
        }

        #username-error,
        #email-error,
        #password-error {
            color: red;
            font-size: 10px;
            font-weight: 500;
            margin-top: -6px;
            margin-bottom: 5px;
            text-align: left;
        }

        button {
            margin-top: 10px;
            width: 100%;
            font-size: 13px;
            font-weight: 600;
            text-align: center;
            justify-content: center;
            align-items: center;
            background: linear-gradient(to right, #007fc9, #005e94);
            color: #fff;
            border: none;
            border-radius: 2px;
            padding: 10px;
            cursor: pointer;
        }

        button:hover {
            background: #007fc9;
        }

        .home {
            text-align: center;
            font-size: 11px;
            margin-top: 5px;
        }

        .home a {
            color: #007fc9;
            text-decoration: none;
            font-weight: 600;
        }

        .home a:hover {
            color: #005e94;
            text-decoration: underline;
        }

        /*-------------- MODEL BOX CSS --------------------*/
        .info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .info-modal-content {
            background: #fff;
            padding: 25px;
            width: 450px;
            max-width: 95%;
            /* border-radius: 12px; */
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.3s ease-in-out;
        }

        .close-info {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            color: #333;
        }

        .modal-body {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .modal-body h2 {
            font-size: 14px;
            margin-bottom: 10px;
            color: #1e3a5f;
        }

        .modal-body p {
            font-size: 11px;
            margin: 10px 0;
            color: #444;
        }

        .modal-body input {
            padding: 10px;
            width: 80%;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 10px;
        }

        .modal-body #pin-error {
            margin-top: 2px;
            font-size: 10px;
            color: red;
        }

        .modal-body input:focus {
            outline: none;
            border: 1px solid #007fc9;
        }

        .modal-body button {
            padding: 10px 20px;
            background: linear-gradient(to right, #007fc9, #005e94);
            color: white;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 13px;
            margin-top: 5px;
        }

        .modal-body button:hover {
            background: #007fc9;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /*-----------------TOAST CSS------------------*/
        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #99cdfa;
            color: black;
            padding: 8px 20px;
            border-radius: 2px;
            display: none;
            font-size: 11px;
            font-weight: 600;
            z-index: 9999;
        }
    </style>
</head>

<body>
    
    <div class="bubble top-left"></div>
    <div class="bubble1 top-right"></div>
    <div class="bubble1 bottom-left"></div>
    <div class="bubble bottom-right"></div>

    <div class="box">
        <h4 class="space">ONLY ADMIN</h4>
        <form id="register-from" class="b1">

            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Laudantium iure doloribus similique dignissimos
                pariatur dolorum corrupti, sapiente earum modi expedita cumque accusamus a est aliquid iste ad, eligendi
                tempora eveniet?</p>

            <p class="error" id="login-error"></p>

            <div class="rf">
                <label for="username">User Name</label>
                <input type="text" id="username" placeholder="username" required oninput="validateUsername() ">
                <p class="error" id="username-error"></p>
            </div>

            <div class="rf">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="email" required oninput="validateEmail()">
                <p class="error" id="email-error"></p>
            </div>

            <div class="rf">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="password" required oninput="validatePassword()">
                <p class="error" id="password-error"></p>
            </div>

            <button class="register" type="button" id="adminbtn" onclick="admin()">ADMIN</button>

            <p class="home">Back to <a href="alllogin.html">Home page</a></p>

            <div id="toast"></div>
        </form>
    </div>

    <script>
        //admin login page 
        // toast msg 
        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.innerText = message;
            toast.style.display = "block";
            setTimeout(() => {
                toast.style.display = "none";
            }, 3000);
        }

        // username validation 
        function validateUsername() {
            const username = document.getElementById("username").value.trim();
            const error = document.getElementById("username-error");
            if (username.length < 3) {
                error.innerText = "Username must be at least 3 characters";
                return false;
            }
            error.innerText = "";
            return true;
        }

        function validateEmail() {
            const email = document.getElementById("email").value.trim();
            const error = document.getElementById("email-error");
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                error.innerText = "Invalid email format";
                return false;
            }
            error.innerText = "";
            return true;
        }

        function validatePassword() {
            const password = document.getElementById("password").value.trim();
            const error = document.getElementById("password-error");
            if (password.length < 6) {
                error.innerText = "Password must be at least 6 characters";
                return false;
            }
            error.innerText = "";
            return true;
        }   

        document.addEventListener("DOMContentLoaded", () => {
            document.addEventListener("keydown", function (event) {
                if (event.key === "Enter") {
                    admin();
                }
            });
        }); 
        //admin pin 
        const adminFixedPin = "Z1234567"; // Only defined here â€“ not saved in localStorage

        function admin() {
            const isNameValid = validateUsername();
            const isEmailValid = validateEmail();
            const isPassValid = validatePassword();
            const errorBox = document.getElementById("login-error");
            errorBox.textContent = "";

            if (!isNameValid || !isEmailValid || !isPassValid) {
                errorBox.textContent = "Please fix validation errors first.";
                errorBox.style.color = "red";
                errorBox.style.textAlign = "center";
                return;
            }

            const username = document.getElementById("username").value.trim();
            const email = document.getElementById("email").value.trim();
            const password = document.getElementById("password").value.trim();
            // admin data
            const allowedAdmin = {
                fullname: "Zarana Patel",
                username: "Zarana",
                email: "zarana1510@gmail.com",
                password: "z12345"
            };

            if (
                username.toLowerCase() !== allowedAdmin.username.toLowerCase() ||
                email.toLowerCase() !== allowedAdmin.email.toLowerCase()
            ) {
                showToast("Only authorized admin can register!");

                // 1.5 seconds
                setTimeout(() => {
                    window.location.href = "alllogin.html";
                }, 1500);

                return;
            }


            if (password === allowedAdmin.password) {
                openAdminPinModal(adminFixedPin, allowedAdmin.fullname);
            } else {
                showToast("Incorrect admin password. Access denied.");

                setTimeout(() => {
                    window.location.href = "alllogin.html";
                }, 1000);
                return;
            }
        }

        function openAdminPinModal(correctPin, fullname) {
            const existingModal = document.querySelector(".info-modal");
            if (existingModal) {
                existingModal.remove();
            }

            const modal = document.createElement("div");
            modal.className = "info-modal";
            modal.innerHTML = `
        <div class="info-modal-content">
            <span class="close-info" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <div class="modal-body">
                <h2>Admin Access Confirmation</h2>
                <p>Welcome <strong>${fullname}</strong>! <br>To confirm access, please enter your secure PIN.</p>
                <input type="password" id="admin-pin" placeholder="Enter Admin PIN" autocomplete="off" />
                <p id="pin-error" style="color: red;"></p>
                <button onclick="verifyAdminPin('${correctPin}')">VERIFY PIN</button>
            </div>
        </div>
        `;
            document.body.appendChild(modal);
        }

        function verifyAdminPin(correctPin) {
            const inputPin = document.getElementById("admin-pin").value.trim();
            const errorMsg = document.getElementById("pin-error");

            if (inputPin.length !== 8) {
                errorMsg.textContent = "PIN must be exactly 8 characters long.";
                return;
            }

            const hasLetter = /[a-zA-Z]/.test(inputPin);
            const hasNumber = /\d/.test(inputPin);

            if (!hasLetter || !hasNumber) {
                errorMsg.textContent = "PIN must contain both letters and numbers.";
                return;
            }

            if (inputPin === correctPin) {
                errorMsg.textContent = "";

                const username = document.getElementById("username").value.trim();
                const email = document.getElementById("email").value.trim();
                const password = document.getElementById("password").value.trim();

                const userData = {
                    username,
                    email,
                    password,
                    role: "admin",
                    loginDate: new Date().toLocaleDateString("en-GB"),
                    loginTime: new Date().toLocaleTimeString("en-GB", {
                        hour: '2-digit', minute: '2-digit'
                    })
                };
                // local storage store 

                let users = JSON.parse(localStorage.getItem("users")) || [];
                users.push(userData);
                localStorage.setItem("users", JSON.stringify(users));
                localStorage.setItem("loggedInUser", JSON.stringify(userData));

                showToast(`Welcome ${username}, you are now logged in! as ADMIN`);
                document.getElementById("register-from").reset();

                document.querySelector(".info-modal").remove();

                setTimeout(() => {
                    window.location.href = "3.html";
                }, 1000);
            } else {
                errorMsg.textContent = "Invalid PIN. Please try again.";
            }
        }
    </script>

</body>

</html>